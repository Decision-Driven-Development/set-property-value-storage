# Основная идея

Идея в том, чтобы создать тонкую прослойку для работы с SPV-хранилищами. Опубликованный интерфейс
прослойки должен позволять выполнить основные CRUD-операции, транслируя их в набор низкоуровневых
запросов, которые затем будут реализованы модулем подключения к конкретному хранилищу (память,
Postgres, Redis и т.п.)

Такая прослойка (и схема хранения) могут помочь с организацией данных в соответствии с принципами
бизнес-моделирования на объектах, т.к. может допускать множественную и динамическую классификацию (
каждый набор данных может относиться к нескольким типам и менять набор этих типов с течением
времени.

Функциональность прослойки базируется на описании из статьи
[Идеализация структуры данных. Идеальная функция](https://www.triz-ri.ru/management/?id=9802&name=idealizacija_struktury_dannyh)

# Общее описание интерфейса

Интерфейс прослойки должен предоставлять следующие методы:

- `Specification add(specifications...)` - добавить новый набор данных или свойство в существующий
  набор
- `Collection get(specifications...)` - получить набор данных или свойство
- `void delete(specifications...)` - удалить набор данных или свойство

Такое ощущение, что спецификации можно типизировать, т.к. уже есть варианты переиспользования
спецификаций в разных операциях. Тогда низкоуровневые методы, делегируемые в конкретные реализации
хранилищ, могут выглядеть так:

- `($Set, $Property, $Value)` - полностью специфицированное значение, уникальная запись отдельного
  свойства конкретного набора из хранилища.
    - `add($Set, $Property, $Value)` - добавить свойство Property со значением Value к набору данных
      Set
    - `delete($Set, $Property, $Value)` - удалить свойство Property набора данных Set, у которого
      значение равно Value
- `($Set, $Property, null)` - спецификация свойства конкретного набора данных
    - `get($Set, $Property, null)` - получить значение свойства Property набора данных Set
    - `delete($Set, $Property, null)` - удалить свойство Property набора данных Set
- `($Set, null, null)` - спецификация набора данных
    - `get($Set, null, null)` - получить все свойства набора данных Set
    - `delete($Set, null, null)` - удалить набор данных Set
- `(null, $Property, $Value)` - спецификация свойства c уникальным значением
    - `add(null, $Property, $Value)` - создать новый набор данных со свойством Property и значением
      Value
    - `get(null, $Property, $Value)` - получить идентификаторы набора данных, у которых свойство
      Property имеет значение Value
- `get(null, $Property, null)` - получить идентификаторы наборов данных, у которых существует
  свойство Property
- `get($Set, null, $Value`) - получить идентификатор свойства набора данных Set, у которого значение
  равно Value

# Детали реализации

- Возможно, что на уровне прослойки понадобится манипулировать как минимум таким объектом, как Set.
  Это даст возможность реализовать метод создания объекта из набора данных, то есть, что-то вроде:
  `Set.asInstanceOf(Target.class)`. А внутри этого метода будет происходить вызов конструктора (через
  рефлексию) и заполнение полей объекта значениями из набора данных, либо вызов статичного фабричного
  метода, которому будет передан набор данных (возможно ли такое при строгой типизации и проверке 
  типов на этапе компиляции?).